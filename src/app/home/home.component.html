<div class="row">
  <h1>Home</h1>
  <div class="col-sm-12 col-md-9">
    <!-- Admin form -->

    <div class=popupContainer  *ngIf="token">
      <button type="button" class="btn btn-info btn-lg buttonForm" (click)="showFormPopup()">add article</button>

      <app-popup *ngIf="displayFormPopup" class=popup [popupTitle]="'Add new Article'" [popupWidth]="5" (onClose)="formPopupOnClose()">
        <div>
          <app-article-form [pageId]="curId" (newArticleEvent)="newArticle($event)"></app-article-form>
        </div>
      </app-popup>
    </div>

    <!-- Articles -->
    <article *ngFor="let article of articles; let i = index; let e = even" class="row card" [ngClass]="{'articleEven': e, 'articleOdd': !e}" id='{{i}}home'>
      <app-article-form *ngIf="article.editing" [pageId]="curId" [article]="article" (newArticleEvent)="article.editing = !article.editing" (deletedArticleEvent)="deleteArticle($event)"></app-article-form>
      <div *ngIf="!article.editing" (click)="article.editing = token ? !article.editing : false">
        <h2>{{article.title}}</h2>
        <div>
          <div *ngIf="article.mimetype && article.mimetype !== 'youtube'">
            <div>
              <img [ngClass]="{'rightImg': e, 'leftImg': !e}" src="/api/public/media/{{article.media}}/show">
            </div>
          </div>
          <div *ngIf="article.mimetype === 'youtube'">
            <div [ngClass]="{'rightImg': e, 'leftImg': !e}">
                <app-youtube-embended [url]="article.media"></app-youtube-embended>
            </div>
          </div>
          <p style="text-indent: 1em;">
                {{article.text}}
          </p>
          <div class="articleFooter">
            <span> Created : {{getPrettyDate(article.created)}}</span>
            <br>
            <span *ngIf="article.created!=article.updated"> Last Update : {{getPrettyDate(article.updated)}}</span>
          </div>
        </div>
      </div>
    </article>
    <div  *ngIf="getListNavPage().length > 1">
      <div class='navPageDivBottom'>
        <button class="btn btn-primary" (click)="offsetChange(-1)">Previous</button>
        <button *ngFor="let button of getListNavPage() ; let i = index;" class="btn btn-outline-primary" [ngClass]="{'btnNavPageCur': offset === button}" (click)="goToOffset(button)">{{i+1}}</button>
        <button class="btn btn-primary" (click)="offsetChange(1)">Next</button>
      </div>
    </div>
  </div>

  <aside class="hidden-sm-down col-md-3">
    <ul>
      <li *ngFor="let article of articles; let i = index; let e = even" class="list-group-item asideMenu" [ngClass]="{'articleEven': e, 'articleOdd': !e}">
        <a (click)="goTo(i+'home')"> {{article.title}}</a>
      </li>
    </ul>
    <div>
      <div class='navPageDiv' *ngIf="getListNavPage().length > 1">
        <button class="btn btn-outline-primary btn-sm" (click)="offsetChange(-1)">←</button>
        <span class='navButtonLike btn-sm'>{{1+offset/nbArticles}} / {{pageCount}}</span>
        <button class="btn btn-outline-primary btn-sm" (click)="offsetChange(1)">→</button>
      </div>
    </div>
  </aside>
</div>
